!customElements.get('media-gallery')&&customElements.define('media-gallery',class MediaGallery extends HTMLElement{constructor(){super();this.elements={liveRegion:this.querySelector('[id^="GalleryStatus"]'),viewer:this.querySelector('[id^="GalleryViewer"]'),thumbnails:this.querySelector('[id^="GalleryThumbnails"]')},this.mql=window.matchMedia('(min-width: 750px)'),this.elements.thumbnails||(this.elements.viewer.addEventListener('slideChanged',debounce(this.onSlideChanged.bind(this),500)),this.elements.thumbnails.querySelectorAll('[data-target]').forEach((t=>t.querySelector('button').addEventListener('click',this.setActiveMedia.bind(this,t.dataset.target,!1)))),this.dataset.desktopLayout.includes('thumbnail')&&this.mql.matches&&this.removeListSemantic())}onSlideChanged(t){const e=this.elements.thumbnails.querySelector(`[data-target="${t.detail.currentElement.dataset.mediaId}"]`);this.setActiveThumbnail(e)}setActiveMedia(t,e){const i=this.elements.viewer.querySelector(`[data-media-id="${t}"]`);this.elements.viewer.querySelectorAll('[data-media-id]').forEach((t=>{t.classList.remove('is-active')})),i.classList.add('is-active'),e&&(i.parentElement.prepend(i),this.elements.thumbnails&&(this.elements.thumbnails.querySelector(`[data-target="${t}"]`).parentElement.prepend(this.elements.thumbnails.querySelector(`[data-target="${t}"]`))),this.elements.viewer.slider&&this.elements.viewer.resetPages()),this.preventStickyHeader(),window.setTimeout((()=>{this.elements.thumbnails?i.parentElement.scrollTo({left:i.offsetLeft}):'stacked'===this.dataset.desktopLayout||i.scrollIntoView({behavior:'smooth'})})),this.playActiveMedia(i),this.elements.thumbnails&&(this.setActiveThumbnail(this.elements.thumbnails.querySelector(`[data-target="${t}"]`)),this.announceLiveRegion(i,this.elements.thumbnails.querySelector(`[data-target="${t}"]`).dataset.mediaPosition))}setActiveThumbnail(t){if(!this.elements.thumbnails||!t)return;this.elements.thumbnails.querySelectorAll('button').forEach((t=>t.removeAttribute('aria-current'))),t.querySelector('button').setAttribute('aria-current',!0),this.elements.thumbnails.isSlideVisible(t,10)||this.elements.thumbnails.slider.scrollTo({left:t.offsetLeft})}announceLiveRegion(t,e){const i=t.querySelector('.product__modal-opener--image img');if(!i)return;i.onload=()=>{this.elements.liveRegion.setAttribute('aria-hidden',!1),this.elements.liveRegion.innerHTML=window.accessibilityStrings.imageAvailable.replace('[index]',e),setTimeout((()=>{this.elements.liveRegion.setAttribute('aria-hidden',!0)}),2e3)},i.src=i.src}playActiveMedia(t){window.pauseAllMedia();const e=t.querySelector('.deferred-media');e&&e.loadContent(!1)}preventStickyHeader(){this.stickyHeader=this.stickyHeader||document.querySelector('sticky-header'),this.stickyHeader&&this.stickyHeader.dispatchEvent(new Event('preventHeaderReveal'))}removeListSemantic(){this.elements.viewer.slider&&(this.elements.viewer.slider.setAttribute('role','presentation'),this.elements.viewer.sliderItems.forEach((t=>t.setAttribute('role','presentation'))))}});
